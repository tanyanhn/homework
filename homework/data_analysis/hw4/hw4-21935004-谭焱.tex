\documentclass[a4paper]{book}
% chktex-file 
% chktex-file 3
\usepackage{geometry}
% make full use of A4 papers
\geometry{margin=1.5cm, vmargin={0pt,1cm}}
\setlength{\topmargin}{-1cm}
\setlength{\paperheight}{29.7cm}
\setlength{\textheight}{25.1cm}

% auto adjust the marginals
\usepackage{marginfix}

\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
% \usepackage{CJKutf8}   % for Chinese characters
\usepackage{ctex}
\usepackage{enumerate}
\usepackage{graphicx}  % for figures
\usepackage{layout}
\usepackage{multicol}  % multiple columns to reduce number of pages
\usepackage{mathrsfs}
\usepackage{fancyhdr}
\usepackage{subfigure}
\usepackage{tcolorbox}
\usepackage{tikz-cd}
\usepackage{listings}
\usepackage{xcolor} %代码高亮
\usepackage{braket}
% ------------------
% common commands %
% ------------------
% differentiation
\newcommand{\gen}[1]{\left\langle#1 \right\rangle}
\newcommand{\dif}{\mathrm{d}}
\newcommand{\difPx}[1]{\frac{\partial#1}{\partial x}}
\newcommand{\difPy}[1]{\frac{\partial#1}{\partial y}}
\newcommand{\Dim}{\mathrm{D}}
\newcommand{\avg}[1]{\left\langle#1 \right\rangle}
\newcommand{\sgn}{\mathrm{sgn}}
\newcommand{\Span}{\mathrm{span}}
\newcommand{\dom}{\mathrm{dom}}
\newcommand{\Arity}{\mathrm{arity}}
\newcommand{\Int}{\mathrm{Int}}
\newcommand{\Ext}{\mathrm{Ext}}
\newcommand{\Cl}{\mathrm{Cl}}
\newcommand{\Fr}{\mathrm{Fr}}
% group is generated by
\newcommand{\grb}[1]{\left\langle#1 \right\rangle}
% rank
\newcommand{\rank}{\mathrm{rank}}
\newcommand{\Iden}{\mathrm{Id}}

% this environment is for solutions of examples and exercises
\newenvironment{solution}%
{\noindent\textbf{Solution.}}%
{\qedhere}
% the following command is for disabling environments
% so that their contents do not show up in the pdf.
\makeatletter
\newcommand{\voidenvironment}[1]{%
  \expandafter\providecommand\csname env@#1@save@env\endcsname{}%
  \expandafter\providecommand\csname env@#1@process\endcsname{}%
  \@ifundefined{#1}{}{\RenewEnviron{#1}{}}%
}
\makeatother

% ---------------------------------------------
% commands specifically for complex analysis %
% ---------------------------------------------
% complex conjugate
\newcommand{\ccg}[1]{\overline{#1}}
% the imaginary unit
\newcommand{\ii}{\mathbf{i}}
% \newcommand{\ii}{\boldsymbol{i}}
% the real part
\newcommand{\Rez}{\mathrm{Re}\,}
% the imaginary part
\newcommand{\Imz}{\mathrm{Im}\,}
% punctured complex plane
\newcommand{\pcp}{\mathbb{C}^{\bullet}}
% the principle branch of the logarithm
\newcommand{\Log}{\mathrm{Log}}
% the principle value of a nonzero complex number
\newcommand{\Arg}{\mathrm{Arg}}
\newcommand{\Null}{\mathrm{null}}
\newcommand{\Range}{\mathrm{range}}
\newcommand{\Ker}{\mathrm{ker}}
\newcommand{\Iso}{\mathrm{Iso}}
\newcommand{\Aut}{\mathrm{Aut}}
\newcommand{\ord}{\mathrm{ord}}
\newcommand{\Res}{\mathrm{Res}}
% \newcommand{\GL2R}{\mathrm{GL}(2,\mathbb{R})}
\newcommand{\GL}{\mathrm{GL}}
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\Dist}[2]{\left|{#1}-{#2}\right|}

\newcommand\tbbint{{-\mkern-16mu\int}}
\newcommand\tbint{{\mathchar'26 -\mkern-14mu\int}}
\newcommand\dbbint{{-\mkern-20mu\int}}
\newcommand\dbint{{\mathchar'26 -\mkern-26mu\int}}
\newcommand\bint{
  {\mathchoice{\dbint}{\tbint}{\tbint}{\tbint}}
}
\newcommand\bbint{
  {\mathchoice{\dbbint}{\tbbint}{\tbbint}{\tbbint}}
}





% ----------------------------------------
% theorem and theorem-like environments %
% ----------------------------------------
\numberwithin{equation}{chapter}
\theoremstyle{definition}

\newtheorem{thm}{Theorem}[chapter]
\newtheorem{axm}[thm]{Axiom}
\newtheorem{alg}[thm]{Algorithm}
\newtheorem{asm}[thm]{Assumption}
\newtheorem{defn}[thm]{Definition}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{rul}[thm]{Rule}
\newtheorem{coro}[thm]{Corollary}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{exm}{Example}[chapter]
\newtheorem{rem}{Remark}[chapter]
\newtheorem{exc}[exm]{Exercise}
\newtheorem{frm}[thm]{Formula}
\newtheorem{ntn}{Notation}

% for complying with the convention in the textbook
\newtheorem{rmk}[thm]{Remark}


% \lstset{
%	backgroundcolor=\color{red!50!green!50!blue!50},%代码块背景色为浅灰色
%	rulesepcolor= \color{gray}, %代码块边框颜色
%	breaklines=true,  %代码过长则换行
%	numbers=left, %行号在左侧显示
%	numberstyle= \small,%行号字体
%	keywordstyle= \color{blue},%关键字颜色
%	commentstyle=\color{gray}, %注释颜色
%	frame=shadowbox%用方框框住代码块
% }
\lstset{
  columns=fixed,
  numbers=left,                                        % 在左侧显示行号
  numberstyle=\tiny\color{gray},                       % 设定行号格式
  frame=none,                                          % 不显示背景边框
  backgroundcolor=\color[RGB]{245,245,244},            % 设定背景颜色
  keywordstyle=\color[RGB]{40,40,255},                 % 设定关键字颜色
  numberstyle=\footnotesize\color{darkgray},
  commentstyle=\it\color[RGB]{0,96,96},                % 设置代码注释的格式
  stringstyle=\rmfamily\slshape\color[RGB]{128,0,0},   % 设置字符串格式
  showstringspaces=false,                              % 不显示字符串中的空格
  language=c++,                                        % 设置语言
}

% ----------------------
% the end of preamble %
% ----------------------

\begin{document}
\pagestyle{empty}
\pagenumbering{roman}
% 
% \tableofcontents
% \clearpage

% \pagestyle{fancy}
% \fancyhead{}
% \lhead{Qinghai Zhang}
% \chead{Notes on Algebraic Topology}
% \rhead{Fall 2018}


\setcounter{chapter}{3}
\pagenumbering{arabic}
% \setcounter{page}{0}

% --------------------------------------------------------
% uncomment the following to remove these environments
% to generate handouts for students.
% --------------------------------------------------------
% \begingroup
% \voidenvironment{rem}%
% \voidenvironment{proof}%
% \voidenvironment{solution}%


% each chapter is factored into a separate file.

\chapter{Homework 21935004 谭焱}
% \begin{lstlisting}
%   int main(){
%   double d;
%   int i;
%   return i;
% }
% \end{lstlisting}
% The main ingredients of snacks are sugar and fat;
% the main ingredients of math are logic and set theory.


% \begin{multicols}{2}
%   \setlength{\columnseprule}{0.2pt}

\section{Problem}\label{sec:1}

\begin{exc}
  Consider $s \in \mathbb{S}_3^2$ on $[0,2]$:
  \begin{align*}
    s(x) =
    \begin{cases}
      p(x) \qquad &\textmd{if } x \in [0,1], \\
      (2-x)^3  \qquad &\textmd{if } x \in [1,2].
    \end{cases}
  \end{align*}
  Determine $p \in \mathbb{P}_3$ such that $s(0) = 0$. Is $s(x)$ a natural cubic spline?
\end{exc}

\begin{solution}
  Let $p(x) = a_3 x^3 + a_2 x^2 + a_1 x + a_0$, Then $s(x)$ is natural cubic implicate
  \begin{align*}
    \begin{cases}
      6 a_3 (0) + 2 a_2 = 0 \\
      6 a_3 (1) + 2 a_2 = 6 (2 -1) \\
      3 a_3 (1)^2 + 2 a_2 (1) + a_1 = 3(2 - 1)^2 \\
      a_3 (1)^3 + a_2 (1)^2 + a_1 (1) + a_0 = (2 - 1)^3
    \end{cases} \Longrightarrow
    \begin{cases}
      a_3 = 1 \\
      a_2 = 0 \\
      a_1 = 0\\
      a_0 = 0
    \end{cases}.
  \end{align*}
  So $p(x) = x^3$.
\end{solution}

\begin{exc}
  Given $f_i = f(x_i)$ of some scalar function at points $a = x_1 < x_2 < \cdots < x_n = b$, we consider interpolating $f$ on $[a,b]$ with a quadratic spline $s \in \mathbb{S}_2^1$.
  \begin{enumerate}[(a)]
  \item Why an additional condition is needed to determine \textit{s} uniquely?

  \item Define $m_i = s^\prime(x_i)$ and $p_i = \left. s \right|_{[x_i,x_{i+1}]}$. Determine $p_i$ in terms of $f_i,f_{i+1}$, and $m_i$ for $i = 1,2, \ldots ,n-1$.

  \item Suppose $m_1 = f^\prime(a)$ is given. Show how $m_2,m_3, \ldots, m_{n-1}$ can be computed.
    
  \end{enumerate}
\end{exc}

\begin{solution}
  \begin{enumerate}[(a)]
  \item Since there are $3n-3$ variables, however only $3n - 4$ functions. Need another propriet function so that have unique solution.

  \item Let $p_i(x) = \frac{(x - x_i)^2}{(x_{i+1} - x_i)^2}(f_{i+1} - f_i)+ \frac{(x - x_i)(x - x_{i+1})}{x_i - x_{i+1}}m_i + f_i$. It can be verify that $p_i(x_i) = f_i,p_i(x_{i+1}) = f_{i+1}, p^\prime(x_i) = m_i$.

  \item As define in (b), derivating $p_i(x)$ in point $x_{i+1}$ get
    \begin{align*}
      m_{i+1} = p_i^\prime(x_{i+1}) = 2 \frac{f_{i+1}- f_i}{x_{i+1}- x_i} - m_i
    \end{align*}
  \end{enumerate}
\end{solution}

\begin{exc}
  Let $s_1(x) = 1 + c(x + 1)^3$ where $x \in [-1,0]$ and $c \in \mathbb{R}$. Determine $s_2(x)$ on $[0,1]$ such that
  \begin{align*}
    s(x) =
    \begin{cases}
      s_1(x) \qquad &\textmd{if } x \in [-1,0],\\
      s_2(x) \qquad &\textmd{if } x \in [0,1]
    \end{cases}
  \end{align*}
  is a natural cubic spline on $[-1,1]$ with knots $-1,0,1$. How must $c$ be chosen if one wants $s(1) = -1$?
\end{exc}

\begin{solution}
  Let $s_2(x) = a_3 x^3 + a_2 x^2 + a_1 x + a_0$. As a natural cubic spline have
  \begin{align*}
    \begin{cases}
      6 a_3 (1) + 2 a_2 = 0 \\
      6 a_3 (0) + 2 a_2 = 6 c((0) + 1) \\
      3 a_3 (0)^2 + 2 a_2 (0) + a_1 = 3c((0) + 1)^2 \\
      a_3 (0)^3 + a_2 (0)^2 + a_1 (0) + a_0 = 1 + c((0) + 1)^3
    \end{cases} \Longrightarrow
    \begin{cases}
      a_3 = -c \\
      a_2 = 3c \\
      a_1 = 3c \\
      a_0 =1 + c \\
    \end{cases}.
  \end{align*}
  So $s_2 = -cx^3 + 3cx^2 + 3cx + 1+c$. From $s_2(1) = s(1) = -1$, conclude $c = -\frac{1}{3}$.
\end{solution}


\begin{exc}
  Consider $f(x) = \cos(\frac{\pi}{2}x)$ with $x \in [-1,1]$.
  \begin{enumerate} [(a)]
  \item Determine the natural cubic spline interpolant to $f$ on knots $-1,0,1$.

  \item As discussed in the class, natural cubic splines have the minimal total bending energy. Verify this by taking $g(x)$ be (i) the quadratic polynomial that interpolates $f$ at $-1,0,1$, and (ii) $f(x)$.
    
  \end{enumerate}
\end{exc}


\begin{solution}
  \begin{enumerate}[(a)]
  \item Define $(x_1,x_2,x_3) = (-1,0,1), (f_1,f_2,f_3) = (f(x_1),f(x_2),f(x_3)) = (0,1,0)$. And let $s(x)$ is natural cubic spline interpolant satisfies $s(x) = s_1(x)\ x \in [-1,0],s(x) = s_2(x)\ x \in [0,1]$. Assume $s_i(x) = a_3^i x^3 + a_2^i x^2 + a_1^i x + a_0^i $, Then have equations
    \begin{align*}
      \begin{cases}
        6 a_3^1 (-1) + 2 a_2^1 = 0 \\
        6 a_3^2 (1) + 2 a_2^2 = 0 \\
        6 a_3^1 (0) + 2 a_2^1 =  6 a_3^2 (0) + 2 a_2^2 \\
        3 a_3^1 (0)^2 + 2 a_2^1 (0) + a_1^1 =  3 a_3^2 (0)^2 + 2 a_2^2 (0) + a_1^2 \\
        a_3^1 (-1)^3 + a_2^1 (-1)^2 + a_1^1 (-1) + a_0^1 = 0 \\
        a_3^1 (0)^3 + a_2^1 (0)^2 + a_1^1 (0) + a_0^1 = 1 \\
        a_3^2 (0)^3 + a_2^2 (0)^2 + a_1^2 (0) + a_0^2 = 1 \\
        a_3^2 (1)^3 + a_2^2 (1)^2 + a_1^2 (1) + a_0^2 = 0
      \end{cases} \Longrightarrow
      \begin{cases}
        a_3^1 = \frac{1}{3} \\
        a_2^1 = -1\\
        a_1^1 = -\frac{1}{3}\\
        a_0^1 = 1 \\
        a_3^2 = \frac{1}{3}\\
        a_2^2 = -1\\
        a_1^2 = -\frac{1}{3}\\
        a_0^2 = 1 
      \end{cases}.
    \end{align*}
    Therefore, $s(x) = \frac{1}{3}x^3 - x^2 - \frac{1}{3}x + 1$ is the natural cubic spline interpolant to $f$ on knots $-1,0,1$.

  \item Interpolating get $g(x) = -x^2 + 1$. Then calculate bending energy
    \begin{align*}
      \int_{-1}^{1}s(x)dx = \left. (\frac{1}{12}x^4 - \frac{1}{3}x^3 - \frac{1}{6}x^2 + x) \right|_{-1}^{1} = \frac{4}{3} \\
      \int_{-1}^{1}g(x)dx = \left. (-\frac{1}{3}x^3 + x)\right|_{-1}^{1} = \frac{4}{3} \\
      \int_{-1}^{1}f(x)dx = \left. (\frac{2}{\pi} \sin(\frac{\pi}{2}x)) \right|_{-1}^{1} = \frac{4}{\pi}.
    \end{align*}
    Which meet the natural cubic spline interpolant is the minimal total bending energy.
  \end{enumerate}
\end{solution}

\begin{exc}
  The quadratic B-spline $B_i^2(x)$.
  \begin{enumerate}[(a)]
  \item Derive the same explicit expression of $B_i^2(x)$ as that in the notes from the recursive Definition of B-splines and the hat function.

  \item Verify that $\frac{d}{dx}B_i^2(x)$ is continuous at $t_i$ and $t_{i+1}$.

  \item Show that only one $x^* \in (t_{i-1},t_{i+1})$ satisfies $\frac{d}{dx}B_i^2(x^*) = 0$. Express $x^*$ in terms of the knots within the interval of support.

  \item Consequently, show $B_i^2(x) \in [0,1)$.

  \item Plot $B_i^2(x)$ for $t_i = i$.
  \end{enumerate}
\end{exc}

\begin{solution}
  \begin{enumerate}[(a)]
  \item We already have
    \begin{align*}
      B_i^1 =
      \begin{cases}
        \frac{x - t_{i-1}}{t_i - t_{i-1}}  \qquad &x \in (t_{i-1},t_i], \\
        \frac{t_{i+1} -x}{t_{i+1} - t_{i}} \qquad &x \in (t_{i},t_{i+1}],
        0  & \textmd{otherwise}.
      \end{cases}
    \end{align*}
    Combining with recursive definition $B_i^{n+1}(x) = \frac{x - t_{i-1}}{t_{i+n} - t_{i-1}}B_i^n(x) + \frac{t_{i+n+1} - x}{t_{i+n+1} - t_i}B_{i+1}^n(x)$, calculate $B_i^2$
    \begin{align*}
      B_i^2 &= \frac{x - t_{i-1}}{t_{i+1} - t_{i-1}}B_i^1(x) + \frac{t_{i+2} - x}{t_{i+2} - t_i}B_{i+1}^1(x) \\
      &=
      \begin{cases}
        0, \qquad &x \in (-\infty,t_{i-1}]; \\ \\
        \frac{x - t_{i-1}}{t_{i+1} - t_{i-1}}B_i^1(x) = \frac{x - t_{i-1}}{t_{i+1} - t_{i-1}}( \frac{x - t_{i-1}}{t_i - t_{i-1}}) =  \frac{(x - t_{i-1})^2}{(t_{i+1} - t_{i-1})(t_i - t_{i-1})}, \qquad &x \in (t_{i-1},t_i]; \\ \\
        \frac{x - t_{i-1}}{t_{i+1} - t_{i-1}}(\frac{t_{i+1} -x}{t_{i+1} - t_{i}}) + \frac{t_{i+2} - x}{t_{i+2} - t_i}( \frac{x - t_{i}}{t_{i+1} - t_{i}}) =  \frac{(x - t_{i-1})(t_{i+1} - x)}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} + \frac{(x - t_{i})(t_{i+2} - x)}{(t_{i+2} - t_{i})(t_{i+1} - t_i)}, \qquad &x \in (t_{i},t_{i+1}]; \\ \\
        \frac{t_{i+2} - x}{t_{i+2} - t_i}( \frac{t_{i+2} -x}{t_{i+2} - t_{i+1}}) = \frac{(t_{i+2} - x)^2}{(t_{i+2} - t_{i})(t_{i+2} - t_{i+1})}, \qquad &x \in (t_{i+1},t_{i+2}]; \\ \\
        0, \qquad &x \in (t_{i+2},+\infty);
      \end{cases}
    \end{align*}

  \item From $B_i^2$ in (a) calculate
    \begin{align*}
      \lim\limits_{x \rightarrow t_i^-}(\frac{(x - t_{i-1})^2 - (t_i - t_{i-1})^2}{(t_{i+1} - t_{i-1})(t_i - t_{i-1})(x - t_i)}) =  \lim\limits_{x \rightarrow t_i^-}(\frac{(x + t_i - 2t_{i-1})}{(t_{i+1} - t_{i-1})(t_i - t_{i-1})}) = \frac{2}{(t_{i+1} - t_{i-1})} \\
      \lim\limits_{x \rightarrow t_i^+}( \frac{(x - t_{i-1})(t_{i+1} - x) - (t_i - t_{i-1})(t_{i+1} - t_i)}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)(x - t_{i})} + \frac{(x - t_{i})(t_{i+2} - x)- (t_i - t_{i})(t_{i+2} - t_i)}{(t_{i+2} - t_{i})(t_{i+1} - t_i)(x -t_{i})})\\
      = \lim\limits_{x \rightarrow t_i^+}( \frac{(t_{i+1} + t_{i-1} - t_i - x)}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} + \frac{(t_{i+2} - x)}{(t_{i+2} - t_{i})(t_{i+1} - t_i)}) = \frac{2}{(t_{i+1} - t_{i-1})}.
    \end{align*}
    So $\frac{d}{dx}B_i^2(x)$ is continuous in $t_i$, $t_{i+1}$ proved similarly.

  \item It is easy to see that $\frac{d}{dx}B_i^2(x) \neq 0, \forall x \in (t_{i-1}, t_i] \cap [t_{i+1}, t_{i+2})$. So it is left to verify $x \in (t_i,t_{i+1})$.
    \begin{align*}
      \frac{d}{dx}B_i^2(x) = \frac{(t_{i+1} - x) - (x - t_{i-1})}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} + \frac{(t_{i+2} - x) - (x - t_{i})}{(t_{i+2} - t_{i})(t_{i+1} - t_i)}
    \end{align*}
    This is a linear function. Take it as $f(x)$. Since $f(t_i) =  \frac{2}{(t_{i+1} - t_{i-1})} > 0$ and $f(t_{i+1}) = -\frac{2}{(t_{i+2} - t_{i})} < 0$, there is a root $x^*$ of $f(x)$ and it's the only one. Then calculate get $x^* = \frac{t_{i+2}t_{i+1} - t_{i}t_{i-1}}{t_{i+2} + t_{i+1} - t_{i} - t_{i-1}}$.
  \item Since $\frac{d}{dx}B_i^2(x) > 0, \forall x \in (t_{i-1},x^*)$ and $\frac{d}{dx}B_i^2(x) < 0, \forall x \in (x^*,t_{i+2})$. It indicates that
    \begin{align*}
      &B_i^2(x) < B_i^2(x^*)  \\
      &= (\frac{1}{t_{i+2} + t_{i+1} - t_{i} - t_{i-1}})^2\\
        &( \frac{(t_{i+2}t_{i+1} - t_{i}t_{i-1} - t_{i+2}t_{i-1} - t_{i+1}t_{i-1} + t_{i}t_{i-1} + t_{i-1}^2 )(t_{i+1}(t_{i+2} + t_{i+1} - t_{i} - t_{i-1}) - t_{i+2}t_{i+1} + t_{i}t_{i-1})}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} + \\
      &\frac{(t_{i+2}t_{i+1} - t_{i}t_{i-1} - t_{i}(t_{i+2} + t_{i+1} - t_{i} - t_{i-1}))(t_{i+2}(t_{i+2} + t_{i+1} - t_{i} - t_{i-1}) - t_{i+2}t_{i+1} + t_{i}t_{i-1})}{(t_{i+2} - t_{i})(t_{i+1} - t_i)}) \\
      &= (\frac{1}{t_{i+2} + t_{i+1} - t_{i} - t_{i-1}})^2((t_{i+2}- t_{i-1})(t_{i+1}- t_{i-1}) + (t_{i+2}-t_{i})(t_{i+2}-t_{i-1})) \\
      &= \frac{t_{i+2} - t_{i-1}}{t_{i+2} + t_{i+1} - t_{i} - t_{i-1}} \\
      &< 1. \\ \\
      B_i^2(x) \geq \min{B_i^2(t_{i-1}), B_i^2(t_{i+2})} = 0.
    \end{align*}
    In summary, $B_i^2(x) \in [0,1)$.

  \item Plot $B_0^2$ blow (\ref{fig:2}), other $i$ can be geted from translation.
    \begin{figure}
      \centering
      \includegraphics[scale=0.25]{Bspline.png}
      \caption{Bspline: ($t_i = i = 0$)}\label{fig:2}
    \end{figure}
  \end{enumerate}
\end{solution}

\begin{exc}
  We proved a theorem on constructing B-splines from truncated power functions,
  \[B_i^n(x) = (t_{i+n} - t_{i-1}) \cdot [t_{i-1}, \ldots ,t_{i+n}](t - x)_+^n.\]
  Verify it algebraically for the case of $n = 2$, i.e.
  \[(t_{i+2} - t_{i-1})[t_{i-1},t_i,t_{i+1},t_{i+2}](t - x)_+^2 = B_i^2.\]
\end{exc}

\begin{solution}
  We already have
  \begin{align*}
    B_i^2 =
    \begin{cases}
      \frac{(x - t_{i-1})^2}{(t_{i+1} - t_{i-1})(t_i - t_{i-1})}, \qquad &x \in (t_{i-1},t_i]; \\
      \frac{(x - t_{i-1})(t_{i+1} - x)}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} + \frac{(x - t_{i})(t_{i+2} - x)}{(t_{i+2} - t_{i})(t_{i+1} - t_i)}, \qquad &x \in (t_{i},t_{i+1}]; \\
      \frac{(t_{i+2} - x)^2}{(t_{i+2} - t_{i})(t_{i+2} - t_{i+1})}, \qquad &x \in (t_{i+1},t_{i+2}]; \\
      0, \qquad &\textmd{otherwise}.
    \end{cases}
  \end{align*}
  And Split the difference format
  \begin{align*}
    B_i^2 &= (t_{i+2} - t_{i-1})[t_{i-1},t_i,t_{i+1},t_{i+2}](t - x)_+^2 \\
          &= [t_i,t_{i+1},t_{i+2}](t - x)_+^2 - [t_{i-1},t_i,t_{i+1}](t - x)_+^2 \\
          &= \frac{(t_{i+2}-x)_+^2 - (t_{i+1}-x)_+^2}{(t_{i+2}-t_{i})(t_{i+2}-t_{i+1})} -
            \frac{(t_{i+1}-x)_+^2 - (t_{i}-x)_+^2}{(t_{i+2}-t_{i})(t_{i+1}-t_{i})} -
            \frac{(t_{i+1}-x)_+^2 - (t_{i}-x)_+^2}{(t_{i+1}-t_{i-1})(t_{i+1}-t_{i})} +
            \frac{(t_{i}-x)_+^2 - (t_{i-1}-x)_+^2}{(t_{i+1}-t_{i-1})(t_{i}-t_{i-1})} \\
    &=
      \begin{cases}
        = 0, & x \in (t_{i+2}, +\infty); \\ \\
        \frac{(t_{i+2} - x)^2}{(t_{i+2} - t_{i})(t_{i+2} - t_{i+1})}, \qquad &x \in (t_{i+1},t_{i+2}];\\ \\
        (\frac{(t_{i+2}-x)_+^2 - (t_{i+1}-x)_+^2}{(t_{i+2}-t_{i})(t_{i+2}-t_{i+1})} -
        \frac{(t_{i+1}-x)_+^2 - (t_{i}-x)_+^2  }{(t_{i+2}-t_{i})(t_{i+1}-t_{i})} - \frac{(t_{i}-x)}{(t_{i+2}-t_{i})(t_{i+1}-t_{i})}) -
        \frac{(t_{i+1}-x)_+^2 }{(t_{i+1}-t_{i-1})(t_{i+1}-t_{i})} \\
        = (\frac{t_{i+2} + t_{i+1} - 2x}{t_{i+2} - t_{i}} - \frac{t_{i+1} + t_{i} - 2x}{t_{i+2} - t_{i}}) - \frac{(t_{i+1} - t_{i-1})(t_i -x)^2 + (t_{i+2} - t_{i})(t_{i+1} - x)^2}{(t_{i+2} - t_{i})(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} \\
        = 1 - \frac{(t_{i+1} - t_{i-1})(t_i -x)^2 + (t_{i+2} - t_{i})(t_{i+1} - x)^2}{(t_{i+2} - t_{i})(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} \\
        = \frac{(t_{i=1} - t_{i-1})(t_{i+2} - t_{i})(x - t_{i}) - (t_{i+1} - t_{i-1})(t_i -x)^2 + (t_{i+2} - t_{i})(t_{i+1} - x)(x-t_{i-1})}{(t_{i+2} - t_{i})(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} \\
        = \frac{(x - t_{i-1})(t_{i+1} - x)}{(t_{i+1} - t_{i-1})(t_{i+1} - t_i)} + \frac{(x - t_{i})(t_{i+2} - x)}{(t_{i+2} - t_{i})(t_{i+1} - t_i)}, \qquad &x \in (t_{i},t_{i+1}]; \\ \\
        = (\frac{t_{i+2} + t_{i+1} - 2x}{t_{i+2} - t_{i}} - \frac{t_{i+1} + t_{i} - 2x}{t_{i+2} - t_{i}}) - (\frac{t_{i+1} + t_{i} - 2x}{t_{i+1} - t_{i-1}} - \frac{t_{i} + t_{i-1} - 2x}{t_{i+1} - t_{i-1}}) +  \frac{(t_{i+2} - x)^2}{(t_{i+2} - t_{i})(t_{i+2} - t_{i+1})} \\
        =  \frac{(t_{i+2} - x)^2}{(t_{i+2} - t_{i})(t_{i+2} - t_{i+1})}, \qquad &x \in (t_{i+1},t_{i+2}]; \\ \\
        = (\frac{t_{i+2} + t_{i+1} - 2x}{t_{i+2} - t_{i}} - \frac{t_{i+1} + t_{i} - 2x}{t_{i+2} - t_{i}}) - (\frac{t_{i+1} + t_{i} - 2x}{t_{i+1} - t_{i-1}} - \frac{t_{i} + t_{i-1} - 2x}{t_{i+1} - t_{i-1}}) \\
        = 1 - 1 = 0 , \qquad &x \in (-\infty,t_{i-1}];
      \end{cases}
  \end{align*}
\end{solution}

\section{programming}\label{sec:2}

\begin{enumerate}[(a)]
\item Write a \textbf{C++} subroutine for cubic-spline interpolation of the function
  \[f(x) = \frac{1}{1 + 25x^2}\]
  on evenly spaced nodes within the interval $[-1,1]$ with $N = 6,11,21,41,81$. Compute the max-norm of interpolation errors at the nodes for each $N$ and report the errors and convergence rates with respect to the number of subintervals.
\item Write a \textbf{Matlab} subroutine to illustrate (1) by ploting the truncated power functions and building a table of divided difference where the entries are figures intread of numbers. See the hinits in Section4.
\end{enumerate}

\begin{solution}
  Source code in file code. Output in code/output.
  
  \begin{enumerate} [(a)]
  \item Run program by \textit{make run}, Or \textit{make} generates \textit{make.ex}. Runing this followed by 5 output files' name. Such as \textit{./main.ex output1 output2 output3 output4 output5 output6}. \textbf{matlab} program \textit{p.m} is used to print interpolants and errors.

  \item Run program by \textit{ make bsp1} and \textit{make bsp2} corresponds to $n = 1$ and $n = 2$. Or using \textbf{matlab} to run function \textit{plotTruncatedPowerFunc2Bsplines} in \textit{plotTruncatedPowerFunc2Bsplines.m}. Outcome is similar to figure ()
    \begin{figure}
      \centering
      \includegraphics[scale = 0.25]{code/n=2.png};
      \caption{N = 1}\label{fig:3}
    \end{figure}
    \begin{figure}
      \centering
      \includegraphics[scale = 0.25]{code/n=3.png}
      \caption{N = 2}\label{fig:4}
    \end{figure}
  \end{enumerate}
\end{solution}











%   \section{1}
%   \label{sec:logic}
%   \input{sec/logic.tex}

%   \section{Ordered sets}
%   \label{sec:sets}
%   \input{sec/orderedSets.tex}

%   \section{Linear algebra}
%   \label{sec:line-algebra}
%   \input{sec/linearAlgebra.tex}


% \end{multicols}


\end{document}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

% LocalWords:  FPN underflows denormalized FPNs matlab eps IEEE iff
% LocalWords:  cardinality significand quadratically bijection unary
% LocalWords:  contractive bijective postcondition invertible arity
% LocalWords:  subspaces surjective injective monomials additivity
% LocalWords:  nullary Abelian abelian finitary eigenvectors adjoint
% LocalWords:  eigenvector nullspace Hermitian unitarily multiset
% LocalWords:  nonsingular nonconstant homomorphism homomorphisms
% LocalWords:  isomorphically indeterminates subfield isomorphism
% LocalWords:  nondefective diagonalizable contrapositive cofactor
% LocalWords:  submatrix nilpotent positivity orthonormal extremum
% LocalWords:  Jacobian nonsquare semidefinite nonnegative RHS LLS
% LocalWords:  roundoff closedness

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
